@page "/"

@using appointment_context_menu.Models
@using appointment_context_menu.Services

@inject AppointmentService ApptService

Because of the flags set in the appointment modes, you cannot delete the "Conference" and "Vet Visit" appointments.
This is reflected in the context menu options for them to showcase sample logic for altering its items.

<TelerikScheduler Data="@Appointments"
                  @bind-Date="@StartDate" Height="600px" @bind-View="@CurrView">
    <SchedulerViews>
        <SchedulerDayView StartTime="@DayStart" />
        <SchedulerWeekView StartTime="@DayStart" />
        <SchedulerMultiDayView StartTime="@DayStart" NumberOfDays="10" />
    </SchedulerViews>
    <ItemTemplate>
        <AppointmentWithContextMenu Appointment="@( context as SchedulerAppointment )" OnUpdateHappened="@GetAppointments" />
    </ItemTemplate>
    <AllDayItemTemplate>
        <AppointmentWithContextMenu Appointment="@( context as SchedulerAppointment )" OnUpdateHappened="@GetAppointments" />
    </AllDayItemTemplate>
</TelerikScheduler>

@code {
    public DateTime StartDate { get; set; }
    public SchedulerView CurrView { get; set; } = SchedulerView.Week;
    public DateTime DayStart { get; set; }
    List<SchedulerAppointment> Appointments { get; set; }

    protected override async Task OnInitializedAsync()
    {
        DateTime start = ApptService.GetStartTime();
        StartDate = start;
        DayStart = start;
        await GetAppointments();
    }

    async Task GetAppointments()
    {
        Appointments = new List<SchedulerAppointment>(await ApptService.GetAppointmentsAsync());
        
    }
}